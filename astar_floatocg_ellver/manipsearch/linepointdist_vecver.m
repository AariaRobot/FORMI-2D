function distances=linepointdist_vecver(lps1,lps2,point)
nvecs=(lps2-lps1)./sqrt(sum((lps1-lps2).^2));
vecstolines=(point-lps1)-nvecs.*dot((point-lps1),nvecs);
psonlines=-vecstolines+point;
lowxps=sign(psonlines(1,:)-min(lps1(1,:),lps2(1,:)));
lowxps=1-sign(lowxps+0.5);
lowxps=lowxps/2;
highxps=sign(psonlines(1,:)-max(lps1(1,:),lps2(1,:)));
highxps=sign(highxps-0.5);
highxps=sign(highxps+1);
lowyps=sign(psonlines(2,:)-min(lps1(2,:),lps2(2,:)));
lowyps=1-sign(lowyps+0.5);
lowyps=lowyps/2;
highyps=sign(psonlines(2,:)-max(lps1(2,:),lps2(2,:)));
highyps=sign(highyps-0.5);
highyps=sign(highyps+1);
outrangeinds=sign(lowxps+highxps+lowyps+highyps);
outrangeinds=logical(outrangeinds);
lpvec=[lps1;lps2];
outrangepoints=lpvec(:,outrangeinds);
outrangedists=min([sqrt(sum((outrangepoints(1:2,:)-point).^2));sqrt(sum((outrangepoints(3:4,:)-point).^2))]);
inrangeinds=logical(1-outrangeinds);
inrangepoints=lpvec(:,inrangeinds);
inrangedists=sqrt(sum(vecstolines(:,inrangeinds).^2));
distances=zeros(1,length(inrangepoints));
distances(outrangeinds)=outrangedists;
distances(inrangeinds)=inrangedists;
end